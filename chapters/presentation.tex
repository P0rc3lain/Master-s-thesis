%
%  Copyright © 2022 Mateusz Stompór. All rights reserved.
%

\chapter{Prezentacja działania}
Ostatni rozdział pracy poświęcony jest przedstawieniu wykorzystania biblioteki w prawdziwym zastosowaniu.
Decyzja pozwoli sprawdzić stabilność, wydajność oraz przystępność interfejsu.
Będzie także okazją na dostrzeżenie potencjalnych problemów oraz nakreślenie kierunku przyszłego rozwoju.
\section{Aplikacja demonstracyjna}
W trakcie rozwijania projektu tworzono wiele scen poglądowych, które w zamyśle miały weryfikować i pokazywać możliwości.
Były one jednak często ściśle skrojone pod daną funkcjonalność i nie dawały pełnego obrazu w kwestii jakości integracji pomiędzy aplikacją, a biblioteką.
Zdecydowano, że reprezentatywny przykład powinien być dziełem kompletnym pod względem funkcjonalności i realizować przypadek użycia zadany podczas projektowania silnika.
Z tego względu zdecydowano się na tworzenie aplikacji, będącej grą.
Jako cel wybrano szachy.
\fig{images/chess/gameplay.png}
    {Gra szachowa stworzona na potrzeby projektu}
    {fig:chess}
    {10cm}
\subsection{Forma}
Aplikacja stworzona została z przeznaczeniem na ekosystem Apple.
Projekt zawiera w sobie wariant dla platform macOS, iOS, iPadOS oraz tvOS.
Każdy z nich pozwala na uruchomienie gry z widokiem planszy oraz swobodną rozgrywkę.
Największy nacisk położono jednak na wersję stacjonarną, przez wzgląd na najefektywniejsze programowanie.
Z tego względu opis obejmie jej perspektywę, choć pamiętać należy, że adaptacja rozwiązań na urządzenia mobilne nie stanowiłaby problemu zważywszy na fakt, że silnik uruchamia się i funkcjonuje poprawnie.
\par
Renderowanie grafiki wymagało skorzystanie z interfejsu okienkowego.
Dostęp do niego uzyskać można zarówno w momencie rozwoju aplikacji uruchamianej z wiersza poleceń, jak i natywnej dla systemu paczki \textit{.app}.
Silne ukierunkowanie na ekosystem sprawiło, że zdecydowano się użyć drugiej możliwości.
\par
Dystrybucja w postaci pliku \textit{.app} niesie za sobą dodatkowe konsekwencje.
Producent wymaga, aby były one podpisane za pomocą certyfikatu poświadczonego przez niego samego.
Czytelnicy pracy z tego względu mogą własnoręcznie skompilować projekt i utworzyć paczkę w oparciu o swoje dane deweloperskie.
Alternatywnie, przygotowano uprzednio zbudowany plik binarny podpisany przez autora pracy.
Uczestnictwo w programie deweloperskim Apple sprawia, że plik uruchomiony może być nie tylko na osobistej maszynie osoby kompilującej kod, ale także na innych.
\subsection{Materiały}
Modele figur, planszy, a także tekstury użyte w pracy stanowią własność intelektualną osób trzecich.
Upewniono się, że licencje dostarczane wraz z nimi umożliwiają nieodpłatne wykorzystanie w celach naukowych.
Nie zostały stworzone one na potrzeby rozwoju aplikacji.
Zdecydowano się zrezygnować z tego kroku, ponieważ własnoręcznie modelowanie nie wpłynęłoby na cel, który starano się osiągnąć.
\subsection{Logika gry}
Aplikacja zawiera pełną implementację logiki szachowej z uwzględnieniem \textit{el passant}, roszady oraz promocji figur.
Użytkownicy mogą anulować wybór figury i zmienić ją już po wybraniu.
Nie poddano restrykcji czasowej także czasu przeznaczonego na turę zawodnika.
\par
Rozgrywka zakończyć może się wygraną jednego z graczy bądź remisem.
Wygrana stwierdzana jest w sytuacji gdy nastąpi szach-mat na królu zawodnika.
Pierwszą sytuacją w której zachodzi remis jest pat \longpause wszystkie możliwe ruchy doprowadziłyby do szachu.
Drugi przypadek opera się o zasadę pięćdziesięciu.
Jeśli podczas kolejnych pięćdziesięciu ruchów żaden z graczy nie zmienił pozycji giermka ani przeprowadził bicia.
Zdecydowano się nie umożliwić zawodnikom poddania się ani ogłoszenia remisu na podstawie chęci z obu stron.
\subsection{Sterowanie}
Interakcja z aplikacją oparta jest o wykorzystanie myszki i klawiatury.
Za pomocą klawiszy \textit{A} oraz \textit{D} użytkownik może dokonywać rotacji kamery zmieniając pozycję z której obserwuje scenę.
Selekcja figury dokonywana jest za pomocą kursora myszy.
Aplikacja sygnalizuje wybór unosząc figurę nieznacznie ponad obszar planszy.
Wówczas użytkownik może wybrać docelowe pole na które chce poruszyć lub kliknąć poza obszar mapy, aby zmienić wybrany pionek.
\subsection{Ruch}
Chcąc wykorzystać możliwie dużo z możliwości biblioteki zadbano o animacje.
Tak jak zaznaczone wcześniej wybór figury jest sygnalizowany zmianą pozycji, która następuje za pomocą płynnego ruch.
Podobnie w sytuacji gdy wybór figury jest anulowany.
Przejście z jednego pola do innego wykorzystuje podobny efekt.
Figura unoszona jest ponad plansze, przenoszona do docelowego pola, a następnie opuszczana.
\subsection{Sesje gry}
Otwarte okno odpowiada pojedynczej sesji gry.
Dopuszczone jest toczenie wielu równoległych rozgrywek.
Wówczas obok siebie widoczna jest mnoga liczba obszarów roboczych.
Każda z nich jest od siebie niezależna.
Obsługa logiki, jak i proces generowania grafiki obsługiwany jest przez osobne, tworzone przy inicjacji okna instancje odpowiednich klas.
Sesje nie są persystentne.
Zamknięcie okna lub całej aplikacji wiąże się z bezpowrotnym utraceniem stanu rozgrywki.
\fig{images/chess/chess-sessions.png}
    {Interfejs pozwalający na tworzenie wielu sesji}
    {fig:chess-sessions}
    {10cm}
% \section{Implementacja}
% tutaj powinienem opisać co i jak